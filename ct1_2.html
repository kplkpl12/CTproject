<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>짝궁 카드 찾기</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
    }
    .card-container {
      display: grid;
      grid-template-columns: repeat(5, 100px);
      gap: 10px;
      justify-content: center;
      margin-top: 20px;
    }
    .card {
      width: 100px;
      height: 140px;
      background-color: gray;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .card.flipped {
      background-color: #f0f0f0;
      color: black;
      cursor: default;
    }
    .card.wrong {
      background-color: red !important;
      color: white;
    }
    .controls {
      margin: 10px;
    }
    .disabled {
      pointer-events: none;
      opacity: 0.5;
    }
  </style>
</head>
<body>
  <h1>짝궁 카드 찾기(원소 기호와 이름 외우기)</h1>
  <p>규칙: 원소 기호와 원소 이름 짝이 맞는 카드를 찾아 뒤집어라. (단, 어려움인 경우 원소번호가 작은 것 부터 뒤집으시오.)</p>

  <div class="controls">
    난이도: 
    <select id="difficulty">
      <option value="easy">쉬움</option>
      <option value="hard">어려움</option>
    </select>
    시간제한: 
    <select id="timerLimit">
      <option value="30">30초</option>
      <option value="60">1분</option>
    </select>
    <button onclick="startGame()">게임시작</button>
  </div>

  <div id="timer"></div>
  <div class="card-container" id="cardContainer"></div>
  <audio id="wrongSound" src="https://www.soundjay.com/button/beep-07.wav"></audio>

  <script>
    const elements = [
      {symbol: 'H', name: '수소', number: 1},
      {symbol: 'He', name: '헬륨', number: 2},
      {symbol: 'Li', name: '리튬', number: 3},
      {symbol: 'Be', name: '베릴륨', number: 4},
      {symbol: 'B', name: '붕소', number: 5},
      {symbol: 'C', name: '탄소', number: 6},
      {symbol: 'N', name: '질소', number: 7},
      {symbol: 'O', name: '산소', number: 8},
      {symbol: 'F', name: '플루오린', number: 9},
      {symbol: 'Ne', name: '네온', number: 10},
      {symbol: 'Na', name: '나트륨', number: 11},
      {symbol: 'Mg', name: '마그네슘', number: 12},
      {symbol: 'Al', name: '알루미늄', number: 13},
      {symbol: 'Si', name: '규소', number: 14},
      {symbol: 'P', name: '인', number: 15},
      {symbol: 'S', name: '황', number: 16},
      {symbol: 'Cl', name: '염소', number: 17},
      {symbol: 'Ar', name: '아르곤', number: 18},
      {symbol: 'K', name: '칼륨', number: 19},
      {symbol: 'Ca', name: '칼슘', number: 20}
    ];

    let cards = [];
    let firstCard = null;
    let lock = false;
    let matched = 0;
    let timeLeft = 0;
    let timerInterval = null;

    function startGame() {
      const container = document.getElementById("cardContainer");
      container.innerHTML = "";
      const difficulty = document.getElementById("difficulty").value;
      const timerLimit = parseInt(document.getElementById("timerLimit").value);
      document.getElementById("timer").textContent = "";

      const selected = elements.sort(() => 0.5 - Math.random()).slice(0, 5);
      cards = [];
      selected.forEach(e => {
        cards.push({...e, type: 'symbol'});
        cards.push({...e, type: 'name'});
      });

      if (difficulty === 'hard') {
        cards.sort((a, b) => a.number - b.number || (a.type === 'symbol' ? -1 : 1));
      } else {
        cards = cards.sort(() => 0.5 - Math.random());
      }

      cards.forEach((c, i) => {
        const card = document.createElement("div");
        card.classList.add("card");
        card.dataset.index = i;
        card.dataset.number = c.number;
        card.onclick = () => flipCard(card);
        container.appendChild(card);
      });

      [...container.children].forEach((card, i) => {
        card.textContent = cards[i].type === 'symbol' ? cards[i].symbol : cards[i].name;
        card.classList.add("flipped");
      });
      setTimeout(() => {
        [...container.children].forEach(card => {
          if (!card.classList.contains("matched")) {
            card.textContent = "";
            card.classList.remove("flipped");
          }
        });
      }, 3000);

      clearInterval(timerInterval);
      timeLeft = timerLimit;
      document.getElementById("timer").textContent = `남은 시간: ${timeLeft}초`;
      timerInterval = setInterval(() => {
        timeLeft--;
        document.getElementById("timer").textContent = `남은 시간: ${timeLeft}초`;
        if (timeLeft <= 0) {
          clearInterval(timerInterval);
          alert("시간 초과! 게임 종료");
          lock = true;
        }
      }, 1000);

      matched = 0;
      firstCard = null;
      lock = false;
    }

    function flipCard(card) {
      if (lock || card.classList.contains("flipped") || card.classList.contains("matched")) return;

      const index = card.dataset.index;
      const data = cards[index];

      if (document.getElementById("difficulty").value === 'hard') {
        const unmatched = cards.filter((_, i) => !document.querySelector(`.card[data-index='${i}']`).classList.contains("matched"));
        const nextNumber = Math.min(...unmatched.map(c => c.number));
        if (data.number !== nextNumber && !firstCard) {
          alert("작은 원소번호부터 뒤집으세요!");
          return;
        }
      }

      card.textContent = data.type === 'symbol' ? data.symbol : data.name;
      card.classList.add("flipped");

      if (!firstCard) {
        firstCard = card;
        return;
      }

      const i1 = firstCard.dataset.index;
      const i2 = card.dataset.index;

      if (cards[i1].number === cards[i2].number && cards[i1].type !== cards[i2].type) {
        firstCard.classList.add("matched");
        card.classList.add("matched");
        matched += 2;
        if (matched === 10) {
          clearInterval(timerInterval);
          alert("Clear! 축하합니다!");
        }
        firstCard = null;
      } else {
        lock = true;
        const wrongSound = document.getElementById("wrongSound");
        wrongSound.play();
        firstCard.classList.add("wrong");
        card.classList.add("wrong");
        setTimeout(() => {
          firstCard.textContent = "";
          card.textContent = "";
          firstCard.classList.remove("flipped", "wrong");
          card.classList.remove("flipped", "wrong");
          firstCard = null;
          lock = false;
        }, 2000);
      }
    }
  </script>
</body>
</html>
